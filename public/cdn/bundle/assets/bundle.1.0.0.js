!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="/cdn/bundle/assets",t(0)}([function(e,t,a){"use strict";var n=a(1),r=a(2),i=a(3),o=a(11),s=a(11);a(21),void[n.name,r.name,s].join(","),_.extend(window,{Application:i.Application,Constants:{StageIDs:o.StageIDs,TeammateRoles:o.TeammateRoles}})},function(e,t){"use strict";t.name="modal",void function(){ko.bindingHandlers[t.name]={init:function(e,t,a,n,r){var i=$(e);i.modal({show:!1}),ko.utils.domNodeDisposal.addDisposeCallback(e,function(){i.modal("destroy")})},update:function(e,t,a,n,r){var i=t(),o=$(e);i?o.modal("show"):o.modal("hide")}}}()},function(e,t){"use strict";t.name="forcibleComputed",void function(){ko[t.name]=function(e,t,a){var n=ko.observable().extend({notify:"always"}),r=ko.computed(function(){return n(),e.call(t)},null,a);return r.evaluateImmediate=function(){n.valueHasMutated()},r}}()},function(e,t,a){"use strict";var n=a(4),r=a(5),i=a(17),o=a(20),s=a(11),u=function(){function e(){this.henchmen=[new n.Henchman(this,s.HenchmanIDs.Garrus,"Garrus Vakarian",!0,3,5,0,8,11,10,2,11,8,0,!1,!1,!0,!1,!0,!0,!1,!0),new n.Henchman(this,s.HenchmanIDs.Grunt,"Grunt",!1,3,0,0,6,9,8,4,9,12,0,!1,!1,!1,!1,!0,!1,!1,!0),new n.Henchman(this,s.HenchmanIDs.Jack,"Jack",!0,0,8,12,5,8,11,1,12,0,8,!1,!0,!1,!1,!0,!1,!0,!0),new n.Henchman(this,s.HenchmanIDs.Jacob,"Jacob Taylor",!0,1,6,0,0,0,6,7,8,0,10,!1,!1,!0,!1,!0,!0,!0,!0),new n.Henchman(this,s.HenchmanIDs.Kasumi,"Kasumi Goto",!1,0,9,0,12,0,3,9,4,0,9,!0,!1,!1,!1,!0,!0,!1,!0),new n.Henchman(this,s.HenchmanIDs.Legion,"Legion",!1,1,3,0,11,0,9,3,10,9,0,!0,!1,!1,!1,!0,!0,!1,!0),new n.Henchman(this,s.HenchmanIDs.Miranda,"Miranda Lawson",!0,1,7,0,0,0,-1,11,2,13,0,!1,!1,!0,!0,!1,!1,!0,!0),new n.Henchman(this,s.HenchmanIDs.Mordin,"Mordin Solus",!0,0,11,0,0,0,5,6,6,10,0,!1,!1,!1,!1,!0,!0,!1,!0),new n.Henchman(this,s.HenchmanIDs.Samara,"Samara",!1,1,4,0,4,7,7,5,7,0,12,!1,!0,!1,!1,!0,!1,!0,!0),new n.Henchman(this,s.HenchmanIDs.Tali,"Tali'zorah",!1,0,10,0,10,0,4,8,5,0,11,!0,!1,!1,!1,!0,!0,!1,!0),new n.Henchman(this,s.HenchmanIDs.Thane,"Thane",!1,1,2,0,9,12,12,0,13,0,13,!1,!1,!1,!1,!0,!0,!0,!0),new n.Henchman(this,s.HenchmanIDs.Zaeed,"Zaeed Masani",!1,3,1,0,7,10,2,10,3,11,0,!1,!1,!1,!1,!0,!1,!1,!0)],this.serialisation=new o.Serialisation(this),this.henchman=ko.observable(void 0),this.state=new i.State(this),this.share=ko.observable(void 0),this.stager=new r.Stager(this),window.location.search.length>2&&this.state.applySerialisedState(window.location.search.substr(1))}return e.renderYesNo=function(e){return e?"Yes":"No"},e.renderRank=function(e){return void 0!==e?"#"+(e+1):'<span class="text-muted">N/A</span>'},e.renderTeammateName=function(t,a){return void 0===a&&(a=!1),t?t.henchman.name+(a?" "+e.ideal_symbol:""):"N/A"},e.renderTeammateNameVentVenter=function(t){return e.renderTeammateName(t,t.willBeEffectiveVentVenter())},e.renderTeammateNameVentLeader=function(t){return e.renderTeammateName(t,t.willBeEffectiveVentLeader())},e.renderTeammateNameLongWalkBubbler=function(t){return e.renderTeammateName(t,t.willBeEffectiveLongWalkBubbler())},e.renderTeammateNameLongWalkLeader=function(t){return e.renderTeammateName(t,t.willBeEffectiveLongWalkLeader())},e.renderTeammateNameLongWalkEscort=function(t){return e.renderTeammateName(t,t.willBeEffectiveLongWalkEscort())},e.renderTeammateNameBossSquadmate=function(t){return e.renderTeammateName(t,t.willSurviveBeingBossSquadmate())},e.renderTeammateNameKeepBaseAdvocate=function(t){return e.renderTeammateName(t,t&&t.henchman.id===s.HenchmanIDs.Miranda)},e.renderTeammateDeathCause=function(e){switch(e){case s.TeammateDeathCauses.ArmourFailure:return"Advanced Armour not acquired";case s.TeammateDeathCauses.ShieldingFailure:return"Advanced Shielding not acquired";case s.TeammateDeathCauses.CannonFailure:return"Thanix Cannon not acquired";case s.TeammateDeathCauses.VentsBadLeader:return"Bad vents leader";case s.TeammateDeathCauses.VentsBadVenter:return"Bad vents choice";case s.TeammateDeathCauses.Escort:return"Disloyal escort";case s.TeammateDeathCauses.LongWalkBadBubbler:return"Bad long walk bubbler";case s.TeammateDeathCauses.LongWalkBadLeader:return"Bad long walk leader";case s.TeammateDeathCauses.Boss:return"Disloyal Boss squadmate";case s.TeammateDeathCauses.HoldTheLine:return"Failed to hold the line";default:return s.TeammateDeathCauses[e]}},e.renderCrewSurvival=function(e){switch(e){case s.SummaryCrewSurvivalOptions.AllDied:return"All Died";case s.SummaryCrewSurvivalOptions.HalfSurvived:return"Half Survived";case s.SummaryCrewSurvivalOptions.AllSurvived:return"All Survived";default:return s.SummaryCrewSurvivalOptions[e]}},e.renderHTLScore=function(e){switch(e){case 0:return"0";case 1:return"➊";case 2:return"➋";case 3:return"➌";case 4:return"➍";default:return e.toString(10)}},e.showArmourDeathRankPopover=function(t,a){return e.showRankPopover($(a.target),"Armour Deaths",t,t.getHenchmenSortedByArmourDeathPriority())},e.showShieldingDeathRankPopover=function(t,a){return e.showRankPopover($(a.target),"Shielding Deaths",t,t.getHenchmenSortedByShieldingDeathPriority())},e.showCannonDeathRankPopover=function(t,a){return e.showRankPopover($(a.target),"Cannon Deaths",t,t.getHenchmenSortedByCannonDeathPriority())},e.showLongWalkDeathRankPopover=function(t,a){return e.showRankPopover($(a.target),"Long Walk Deaths",t,t.getHenchmenSortedByLongWalkDeathPriority())},e.showHTMLDeathRankPopover=function(t,a){return e.showRankPopover($(a.target),"Hold the line Deaths",t,t.getHenchmenSortedByHTLDeathPriority())},e.showDefenceReportRankPopover=function(t,a){return e.showRankPopover($(a.target),"Defence Reports",t,t.getHenchmenSortedByDefenceReportPriority())},e.showKeepBaseAdvocateRankPopover=function(t,a){return e.showRankPopover($(a.target),"Keep Base Advocates",t,t.getHenchmenSortedByKeepBasePriority())},e.showDestroyBaseAdvocateRankPopover=function(t,a){return e.showRankPopover($(a.target),"Destroy Base Advocates",t,t.getHenchmenSortedByDestroyBasePriority())},e.showCutsceneRescueRankPopover=function(t,a){return e.showRankPopover($(a.target),"Catchs Shepard",t,t.getHenchmenSortedByCutsceneRescuePriority())},e.getDelayCandidates=function(){return[s.NormandyDelayOptions.None,s.NormandyDelayOptions.Few,s.NormandyDelayOptions.Many]},e.renderDelayValue=function(e){switch(e){case s.NormandyDelayOptions.None:return"None";case s.NormandyDelayOptions.Few:return"1-3";case s.NormandyDelayOptions.Many:return"More than 3";default:return""+e}},e.showRankPopover=function(e,t,a,n){var r=$("<ol />").addClass("rank-popover-list");_.each(n,function(e){r.append($("<li />").append(e.name))}),e.popover({trigger:"focus",title:t,html:!0,content:r}).on("hidden.bs.popover",function(){e.popover("destroy")}).popover("show")},e.prototype.getHenchmen=function(){return this.henchmen},e.prototype.getHenchman=function(e){return _.find(this.henchmen,function(t){return t.id===e})},e.prototype.predictedToBeDead=function(e){return this.state.stage().is_evaluatable()?!!this.state.stage().evaluate().find(e):!1},e.ideal_symbol="✭",e}();t.Application=u},function(e,t){"use strict";var a=function(){function e(e,t,a,n,r,i,o,s,u,h,l,c,d,m,p,f,y,g,_,v,S,T){void 0===t&&(t=void 0),void 0===a&&(a=""),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===m&&(m=0),void 0===p&&(p=!1),void 0===f&&(f=!1),void 0===y&&(y=!1),void 0===g&&(g=!1),void 0===_&&(_=!1),void 0===v&&(v=!1),void 0===S&&(S=!1),void 0===T&&(T=!1),this.name="",this.app=e,this.id=t,this.name=a,this.is_essential=n,this.htl_value=r,this.htl_death_priority=i,this.armour_death_priority=o,this.shielding_death_priority=s,this.cannon_death_priority=u,this.long_walk_death_priority=h,this.cutscene_rescue_priority=l,this.defence_report_priority=c,this.keep_base_priority=d,this.destroy_base_priority=m,this.is_tech_expert=p,this.is_biotic_expert=f,this.is_leader=y,this.is_super_leader=g,this.is_escort_candidate=_,this.is_vent_candidate=v,this.is_bubble_candidate=S,this.is_leader_candidate=T}return e.prototype.getHenchmenSortedByArmourDeathPriority=function(){return this.getHenchmenSortedBy("armour_death_priority")},e.prototype.getHenchmenSortedByShieldingDeathPriority=function(){return this.getHenchmenSortedBy("shielding_death_priority")},e.prototype.getHenchmenSortedByCannonDeathPriority=function(){return this.getHenchmenSortedBy("cannon_death_priority")},e.prototype.getHenchmenSortedByHTLDeathPriority=function(){return this.getHenchmenSortedBy("htl_death_priority")},e.prototype.getHenchmenSortedByLongWalkDeathPriority=function(){return this.getHenchmenSortedBy("long_walk_death_priority")},e.prototype.getHenchmenSortedByCutsceneRescuePriority=function(){return this.getHenchmenSortedBy("cutscene_rescue_priority")},e.prototype.getHenchmenSortedByDefenceReportPriority=function(){return this.getHenchmenSortedBy("defence_report_priority")},e.prototype.getHenchmenSortedByKeepBasePriority=function(){return _.filter(this.getHenchmenSortedBy("keep_base_priority"),function(e){return e.keep_base_priority>0})},e.prototype.getHenchmenSortedByDestroyBasePriority=function(){return _.filter(this.getHenchmenSortedBy("destroy_base_priority"),function(e){return e.destroy_base_priority>0})},e.prototype.getHTLDeathPriorityRank=function(){return _.indexOf(this.getHenchmenSortedByHTLDeathPriority(),this)},e.prototype.getArmourDeathPriorityRank=function(){return _.indexOf(this.getHenchmenSortedByArmourDeathPriority(),this)},e.prototype.getShieldingDeathPriorityRank=function(){return _.indexOf(this.getHenchmenSortedByShieldingDeathPriority(),this)},e.prototype.getCannonDeathPriorityRank=function(){return _.indexOf(this.getHenchmenSortedByCannonDeathPriority(),this)},e.prototype.getLongWalkDeathPriorityRank=function(){return _.indexOf(this.getHenchmenSortedByLongWalkDeathPriority(),this)},e.prototype.getCutsceneRescuePriorityRank=function(){return _.indexOf(this.getHenchmenSortedByCutsceneRescuePriority(),this)},e.prototype.getDefenceReportPriorityRank=function(){return _.indexOf(this.getHenchmenSortedByDefenceReportPriority(),this)},e.prototype.getKeepBasePriorityRank=function(){return this.keep_base_priority>0?_.indexOf(this.getHenchmenSortedByKeepBasePriority(),this):void 0},e.prototype.getDestroyBasePriorityRank=function(){return this.destroy_base_priority>0?_.indexOf(this.getHenchmenSortedByDestroyBasePriority(),this):void 0},e.prototype.getHenchmenSortedBy=function(e){return _.sortBy(this.app.getHenchmen(),function(t){return t[e]}).reverse()},e}();t.Henchman=a},function(e,t,a){"use strict";var n=a(6),r=a(12),i=a(13),o=a(14),s=a(15),u=a(16),h=function(){function e(e){this.app=e,this.freezes=[],this.stages=_.sortBy([new n.Setup(this),new r.Occulus(this),new i.Vents(this),new o.LongWalk(this),new s.Boss(this),new u.Summary(this)],function(e){return e.id}),this.app.state.stage.subscribe(function(e){e.setup()}),this.can_go_back=ko.observable(!1),this.app.state.stage(this.getStage(0)),this.initial_freeze=this.app.state.serialise()}return e.prototype.getStage=function(e){return this.stages[e]},e.prototype.reset=function(){this.app.state.applySerialisedState(this.initial_freeze)},e.prototype.back=function(){this.can_go_back()&&(this.app.state.applySerialisedState(this.freezes.pop()),this.can_go_back(!!this.freezes.length))},e.prototype.next=function(){var e=this.app.state.stage();e.isEvaluatable()&&(this.freeze(),e.evaluateAndApply(),e.id<this.stages.length-1&&this.app.state.stage(this.getStage(e.id+1)))},e.prototype.freeze=function(){this.freezes.push(this.app.state.serialise()),this.can_go_back(!0)},e}();t.Stager=h},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(7),i=a(11),o=a(10),s=function(e){function t(t){var a=this;e.call(this,t),this.id=i.StageIDs.Setup,this.label="Set up",this.all_recruited=ko.pureComputed({read:function(){return!a.getTeammates().find(function(e){return!e.is_recruited()})},write:function(e){a.getTeammates().each(function(t){!e&&t.henchman.is_essential||t.is_recruited(e)})},owner:this}),this.all_loyal=ko.pureComputed({read:function(){return!a.getTeammates().find(function(e){return!e.is_loyal()})},write:function(e){e?a.getTeammates().each(function(e){e.is_recruited(!0),e.is_loyal(!0)}):a.getTeammates().each(function(e){e.is_loyal(!1)})},owner:this}),this.is_evaluatable=ko.pureComputed(function(){var e=_.filter(a.getTeammates().value(),function(e){return e.is_recruited()}).length>=8;return e})}return n(t,e),t.prototype.evaluate=function(){return new o.TeammateDeathList},t.prototype.getTeammates=function(){return this.stager.app.state.teammates()},t}(r.Stage);t.Setup=s},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(10),o=a(4),s=function(){function e(e){this.stager=e}return e.genericTeammateFieldFilter=function(e){return e.is_recruited()&&!e.is_dead()},e.prototype.evaluate=function(){return new i.TeammateDeathList},e.prototype.evaluateAndApply=function(){this.evaluate().apply()},e.prototype.configureFields=function(e){var t=this;this.fields=[],this.fields=_.map(e,function(e){return new r.TeammateField(t.stager.app.state,function(){return t.fields},e)}),_.each(this.fields,function(e){e.candidates.evaluateImmediate()}),this.is_evaluatable=ko.forcibleComputed(function(){var e=!!_.find(t.fields,function(e){if(e.config.optional)return!1;var t=e.observable();return t?void 0===t.henchman.id:!0});return!e})},e.prototype.getField=function(e){return _.find(this.fields,function(t){return t.config.name===e})},e.prototype.getFieldObservable=function(e){return this.getField(e).observable},e.prototype.getFieldCandidates=function(e){return this.getField(e).candidates},e.prototype.getFieldValue=function(e){return this.getFieldObservable(e)()},e.prototype.setup=function(){var e=this;_.each(this.fields,function(t){var a=e.stager.app.state.teammates().withRole(t.config.role).first(),n=t.observable();a&&(void 0!==n&&n.henchman.id===a.henchman.id||t.observable(a))})},e.prototype.isEvaluatable=function(){return this.is_evaluatable()},e.no_teammate=new n.Teammate(new o.Henchman(void 0,void 0,"— None —")),e}();t.Stage=s},function(e,t){"use strict";var a=function(){function e(e,t,a,n,r){var i=this;void 0===t&&(t=!1),void 0===a&&(a=!1),void 0===n&&(n=!1),void 0===r&&(r=[]),this.henchman=e,this.is_recruited=ko.observable(t),this.is_loyal=ko.observable(t&&a),this.is_dead=ko.observable(n),this.roles=ko.observableArray(r),this.death_cause=ko.observable(void 0),this.death_stage_id=ko.observable(void 0),this.is_recruited.subscribe(function(e){!e&&i.is_loyal()&&i.is_loyal(!1)})}return e.prototype.addRole=function(e){return this.hasRole(e)||this.is_dead()||this.roles.push(e),this},e.prototype.removeRole=function(e){return this.is_dead()||this.roles.remove(e),this},e.prototype.hasRole=function(e){return this.roles.indexOf(e)>-1},e.prototype.hasAnyOfTheseRoles=function(){for(var e=this,t=[],a=0;a<arguments.length;a++)t[a-0]=arguments[a];return _.some(t,function(t){return e.hasRole(t)})},e.prototype.hasAllOfTheseRoles=function(){for(var e=this,t=[],a=0;a<arguments.length;a++)t[a-0]=arguments[a];return _.every(t,function(t){return e.hasRole(t)})},e.prototype.getHoldTheLineScore=function(){return this.henchman.htl_value+(this.is_loyal()?1:0)},e.prototype.willBeEffectiveLongWalkLeader=function(){return this.henchman.is_leader&&(this.is_loyal()||this.henchman.is_super_leader)},e.prototype.willBeEffectiveLongWalkEscort=function(){return this.is_loyal()},e.prototype.willBeEffectiveLongWalkBubbler=function(){return this.is_loyal()&&this.henchman.is_biotic_expert},e.prototype.willSurviveBeingBossSquadmate=function(){return this.is_loyal()},e.prototype.willBeEffectiveVentVenter=function(){return this.henchman.is_tech_expert&&this.is_loyal()},e.prototype.willBeEffectiveVentLeader=function(){return this.henchman.is_leader&&this.is_loyal()},e.prototype.die=function(e,t){return this.death_stage_id(e),this.death_cause(t),this.is_dead(!0),this},e}();t.Teammate=a},function(e,t,a){"use strict";var n=a(7),r=function(){function e(e,t,a){this.config=a,this.observable=ko.observable(void 0),this.candidates=ko.forcibleComputed(function(){var r=e.teammates().filter(function(t){return a.filter(t,e.teammates())}).filter(function(e){return!_.find(t(),function(t){return!(t.config.name===a.name||!t.observable||t.observable()!==e)})}).value();return r.unshift(n.Stage.no_teammate),r}),this.observable.subscribe(function(e){void 0!==a.role&&e&&void 0!==e.henchman.id&&e.removeRole(a.role)},null,"beforeChange"),this.observable.subscribe(function(e){void 0!==a.role&&e.addRole(a.role),_.each(t(),function(e){e.config.name!==a.name&&e.candidates.evaluateImmediate()})})}return e}();t.TeammateField=r},function(e,t){"use strict";var a=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];this.list=e}return e.prototype.apply=function(){return _.each(this.list,function(e){e.teammate.die(e.death_stage_id,e.death_cause)}),this},e.prototype.getAll=function(){return this.list},e.prototype.find=function(e){return _.find(this.list,function(t){return t.teammate.henchman.id===e.henchman.id})},e.prototype.add=function(e){return this.list.push(e),this},e}();t.TeammateDeathList=a},function(e,t){"use strict";!function(e){e[e.Garrus=0]="Garrus",e[e.Grunt=1]="Grunt",e[e.Jack=2]="Jack",e[e.Jacob=3]="Jacob",e[e.Kasumi=4]="Kasumi",e[e.Legion=5]="Legion",e[e.Miranda=6]="Miranda",e[e.Mordin=7]="Mordin",e[e.Morinth=8]="Morinth",e[e.Samara=9]="Samara",e[e.Tali=10]="Tali",e[e.Thane=11]="Thane",e[e.Zaeed=12]="Zaeed"}(t.HenchmanIDs||(t.HenchmanIDs={}));t.HenchmanIDs;!function(e){e[e.None=0]="None",e[e.Few=1]="Few",e[e.Many=2]="Many"}(t.NormandyDelayOptions||(t.NormandyDelayOptions={}));t.NormandyDelayOptions;!function(e){e[e.All=0]="All",e[e.StageID=1]="StageID",e[e.NormandyDelay=2]="NormandyDelay",e[e.NormandyFlags=3]="NormandyFlags",e[e.Teammates=4]="Teammates"}(t.SerialisedElements||(t.SerialisedElements={}));t.SerialisedElements;!function(e){e[e.All=0]="All",e[e.HenchmanID=1]="HenchmanID",e[e.DeathCause=2]="DeathCause",e[e.DeathStageID=3]="DeathStageID",e[e.Roles=4]="Roles"}(t.SerialisedTeammateElements||(t.SerialisedTeammateElements={}));t.SerialisedTeammateElements;!function(e){e[e.ArmourFailure=0]="ArmourFailure",e[e.ShieldingFailure=1]="ShieldingFailure",e[e.CannonFailure=2]="CannonFailure",e[e.VentsBadVenter=3]="VentsBadVenter",e[e.VentsBadLeader=4]="VentsBadLeader",e[e.LongWalkBadBubbler=5]="LongWalkBadBubbler",e[e.LongWalkBadLeader=6]="LongWalkBadLeader",e[e.Escort=7]="Escort",e[e.Boss=8]="Boss",e[e.HoldTheLine=9]="HoldTheLine"}(t.TeammateDeathCauses||(t.TeammateDeathCauses={}));t.TeammateDeathCauses;!function(e){e[e.OcculusSquadmate1=0]="OcculusSquadmate1",e[e.OcculusSquadmate2=1]="OcculusSquadmate2",e[e.VentsSquadmate1=2]="VentsSquadmate1",e[e.VentsSquadmate2=3]="VentsSquadmate2",e[e.VentsVenter=4]="VentsVenter",e[e.VentsLeader=5]="VentsLeader",e[e.LongWalkSquadmate1=6]="LongWalkSquadmate1",e[e.LongWalkSquadmate2=7]="LongWalkSquadmate2",e[e.LongWalkEscort=8]="LongWalkEscort",e[e.LongWalkBubbler=9]="LongWalkBubbler",e[e.LongWalkLeader=10]="LongWalkLeader",e[e.BossSquadmate1=11]="BossSquadmate1",e[e.BossSquadmate2=12]="BossSquadmate2",e[e.HeldTheLine=13]="HeldTheLine"}(t.TeammateRoles||(t.TeammateRoles={}));t.TeammateRoles;!function(e){e[e.Setup=0]="Setup",e[e.Occulus=1]="Occulus",e[e.Vents=2]="Vents",e[e.LongWalk=3]="LongWalk",e[e.Boss=4]="Boss",e[e.Summary=5]="Summary"}(t.StageIDs||(t.StageIDs={}));t.StageIDs;!function(e){e[e.AllSurvived=0]="AllSurvived",e[e.HalfSurvived=1]="HalfSurvived",e[e.AllDied=2]="AllDied"}(t.SummaryCrewSurvivalOptions||(t.SummaryCrewSurvivalOptions={}));t.SummaryCrewSurvivalOptions},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(7),i=a(11),o=a(10),s=function(e){function t(t){e.call(this,t),this.id=i.StageIDs.Occulus,this.label="Occulus",this.configureFields([{name:"occulus_squadmate_1",filter:r.Stage.genericTeammateFieldFilter,role:i.TeammateRoles.OcculusSquadmate1},{name:"occulus_squadmate_2",filter:r.Stage.genericTeammateFieldFilter,role:i.TeammateRoles.OcculusSquadmate2}])}return n(t,e),t.prototype.evaluate=function(){var e=new o.TeammateDeathList,t=this.stager.app.state.teammates().whoAreRecruited().withoutAnyOfTheseRoles(i.TeammateRoles.OcculusSquadmate1,i.TeammateRoles.OcculusSquadmate2);return this.stager.app.state.normandy.has_shielding()||e.add({teammate:t.whoAreAlive().sortByShieldingDeathPriority().last(),death_cause:i.TeammateDeathCauses.ShieldingFailure,death_stage_id:this.id}),this.stager.app.state.normandy.has_armour()||e.add({teammate:t.whoAreAlive().sortByArmourDeathPriority().last(),death_cause:i.TeammateDeathCauses.ArmourFailure,death_stage_id:this.id}),this.stager.app.state.normandy.has_thanix_cannon()||e.add({teammate:t.whoAreAlive().sortByCannonDeathPriority().last(),death_cause:i.TeammateDeathCauses.CannonFailure,death_stage_id:this.id}),e},t}(r.Stage);t.Occulus=s},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(7),i=a(11),o=a(10),s=function(e){function t(t){e.call(this,t),this.id=i.StageIDs.Vents,this.label="Vents",this.configureFields([{name:"vent_squadmate_1",filter:r.Stage.genericTeammateFieldFilter,role:i.TeammateRoles.VentsSquadmate1},{name:"vent_squadmate_2",filter:r.Stage.genericTeammateFieldFilter,role:i.TeammateRoles.VentsSquadmate2},{name:"vent_venter",filter:function(e){return e.is_recruited()&&!e.is_dead()&&e.henchman.is_vent_candidate},role:i.TeammateRoles.VentsVenter},{name:"vent_leader",filter:function(e){return e.is_recruited()&&!e.is_dead()&&e.henchman.is_leader_candidate},role:i.TeammateRoles.VentsLeader}])}return n(t,e),t.prototype.evaluate=function(){var e=new o.TeammateDeathList,t=this.getFieldValue("vent_venter"),a=this.getFieldValue("vent_leader");return t.willBeEffectiveVentVenter()?a.willBeEffectiveVentLeader()||e.add({teammate:t,death_stage_id:this.id,death_cause:i.TeammateDeathCauses.VentsBadLeader}):e.add({teammate:t,death_stage_id:this.id,death_cause:i.TeammateDeathCauses.VentsBadVenter}),e},t}(r.Stage);t.Vents=s},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(7),i=a(11),o=a(10),s=function(e){function t(t){e.call(this,t),this.id=i.StageIDs.LongWalk,this.label="Long Walk",this.configureFields([{name:"long_walk_bubbler",filter:function(e){return e.is_recruited()&&!e.is_dead()&&e.henchman.is_bubble_candidate},role:i.TeammateRoles.LongWalkBubbler},{name:"long_walk_leader",filter:function(e){return e.is_recruited()&&!e.is_dead()&&e.henchman.is_leader_candidate},role:i.TeammateRoles.LongWalkLeader},{name:"long_walk_escort",filter:function(e,t){return t.whoAreAlive().length()<=4?!1:e.is_recruited()&&!e.is_dead()&&e.henchman.is_escort_candidate},optional:!0,role:i.TeammateRoles.LongWalkEscort},{name:"long_walk_squadmate_1",filter:r.Stage.genericTeammateFieldFilter,role:i.TeammateRoles.LongWalkSquadmate1},{name:"long_walk_squadmate_2",filter:r.Stage.genericTeammateFieldFilter,role:i.TeammateRoles.LongWalkSquadmate2}])}return n(t,e),t.prototype.evaluate=function(){var e=new o.TeammateDeathList,t=this.getFieldValue("long_walk_escort"),a=this.getFieldValue("long_walk_bubbler"),n=this.getFieldValue("long_walk_leader");return void 0===t.henchman.id||t.willBeEffectiveLongWalkEscort()||e.add({teammate:t,death_stage_id:this.id,death_cause:i.TeammateDeathCauses.Escort}),a.willBeEffectiveLongWalkBubbler()||e.add({teammate:this.stager.app.state.teammates().withAnyOfTheseRoles(i.TeammateRoles.LongWalkSquadmate1,i.TeammateRoles.LongWalkSquadmate2).sortByLongWalkDeathPriority().last(),death_stage_id:this.id,death_cause:i.TeammateDeathCauses.LongWalkBadBubbler}),n.willBeEffectiveLongWalkLeader()||e.add({teammate:n,death_stage_id:this.id,death_cause:i.TeammateDeathCauses.LongWalkBadLeader}),e},t}(r.Stage);t.LongWalk=s},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(7),i=a(11),o=a(10),s=function(e){function t(t){var a=this;e.call(this,t),this.id=i.StageIDs.Boss,this.label="Boss",this.configureFields([{name:"boss_squadmate_1",filter:function(e){return e.is_recruited()&&!e.is_dead()&&!e.hasRole(i.TeammateRoles.LongWalkEscort)},role:i.TeammateRoles.BossSquadmate1},{name:"boss_squadmate_2",filter:function(e){return e.is_recruited()&&!e.is_dead()&&!e.hasRole(i.TeammateRoles.LongWalkEscort)},role:i.TeammateRoles.BossSquadmate2}]),this.getFieldObservable("boss_squadmate_1").subscribe(function(){a.updateHTLRoles()}),this.getFieldObservable("boss_squadmate_2").subscribe(function(){a.updateHTLRoles()})}return n(t,e),t.prototype.evaluate=function(){var e=this,t=new o.TeammateDeathList,a=this.getFieldValue("boss_squadmate_1"),n=this.getFieldValue("boss_squadmate_2");return a.willSurviveBeingBossSquadmate()||t.add({teammate:a,death_stage_id:this.id,death_cause:i.TeammateDeathCauses.Boss}),n.willSurviveBeingBossSquadmate()||t.add({teammate:n,death_stage_id:this.id,death_cause:i.TeammateDeathCauses.Boss}),this.stager.app.state.teammates().withRole(i.TeammateRoles.HeldTheLine).whoDieHoldingTheLine().each(function(a){t.add({teammate:a,death_stage_id:e.id,death_cause:i.TeammateDeathCauses.HoldTheLine})}),t},t.prototype.updateHTLRoles=function(){var e=this.stager.app.state.teammates().withAnyOfTheseRoles(i.TeammateRoles.BossSquadmate1,i.TeammateRoles.BossSquadmate2),t=this.stager.app.state.teammates().whoAreAlive().whoAreRecruited();e.removeRole(i.TeammateRoles.HeldTheLine),2===e.length()&&t.removeRole(i.TeammateRoles.HeldTheLine).withoutAnyOfTheseRoles(i.TeammateRoles.BossSquadmate1,i.TeammateRoles.BossSquadmate2,i.TeammateRoles.LongWalkEscort).addRole(i.TeammateRoles.HeldTheLine)},t}(r.Stage);t.Boss=s},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(7),i=a(11),o=a(10),s=function(e){function t(t){e.call(this,t),this.id=i.StageIDs.Summary,this.label="Summary",this.shepard_lives=ko.observable(void 0),this.shepard_pulled_up_by=ko.observable(void 0),this.defence_reporter=ko.observable(void 0),this.keep_base_advocate=ko.observable(void 0),this.destroy_base_advocate=ko.observable(void 0),this.crew_survival=ko.observable(void 0),this.is_evaluatable=ko.observable(!1),this.htl_total=ko.observable(void 0),this.htl_score=ko.observable(void 0),this.htl_candidates_count=ko.observable(void 0),this.htl_death_count=ko.observable(void 0)}return n(t,e),t.prototype.evaluate=function(){return new o.TeammateDeathList},t.prototype.setup=function(){var e=this.stager.app.state.teammates().withRole(i.TeammateRoles.HeldTheLine);this.defence_reporter(this.getDefenceReporter()),this.shepard_lives(this.getShepardLives()),this.shepard_pulled_up_by(this.getShepardCatcher()),this.keep_base_advocate(this.getKeepBaseAdvocate()),this.destroy_base_advocate(this.getDestroyBaseAdvocate()),this.crew_survival(this.getCrewSurvival()),this.htl_total(e.getHoldTheLineTotal()),this.htl_score(e.getHoldTheLineScore().toFixed(2)),this.htl_candidates_count(e.length()),this.htl_death_count(e.getHoldTheLineDeathCount())},t.prototype.getLivingTeammates=function(){return this.stager.app.state.teammates().whoAreAlive().whoAreRecruited()},t.prototype.getShepardLives=function(){return this.getLivingTeammates().length()>1},t.prototype.getShepardCatcher=function(){var e=this.getLivingTeammates().sort(function(e){var t=e.henchman.cutscene_rescue_priority+(e.hasAnyOfTheseRoles(i.TeammateRoles.BossSquadmate1,i.TeammateRoles.BossSquadmate2)?100:0);return t});return e.length()>1?e.last():void 0},t.prototype.getDefenceReporter=function(){return this.stager.app.state.teammates().withRole(i.TeammateRoles.HeldTheLine).sortByDefenceReportPriority().last()},t.prototype.getKeepBaseAdvocate=function(){return this.stager.app.state.teammates().withAnyOfTheseRoles(i.TeammateRoles.BossSquadmate1,i.TeammateRoles.BossSquadmate2).whoAdvocateKeepingTheBase().sortByKeepBasePriority().last()},t.prototype.getDestroyBaseAdvocate=function(){return this.stager.app.state.teammates().withAnyOfTheseRoles(i.TeammateRoles.BossSquadmate1,i.TeammateRoles.BossSquadmate2).whoAdvocateDestroyingTheBase().sortByDestroyBasePriority().last()},t.prototype.getCrewSurvival=function(){return 0===this.stager.app.state.teammates().withRole(i.TeammateRoles.LongWalkEscort).length()?i.SummaryCrewSurvivalOptions.AllDied:this.stager.app.state.normandy.delay()===i.NormandyDelayOptions.None?i.SummaryCrewSurvivalOptions.AllSurvived:this.stager.app.state.normandy.delay()===i.NormandyDelayOptions.Few?i.SummaryCrewSurvivalOptions.HalfSurvived:i.SummaryCrewSurvivalOptions.AllDied},t}(r.Stage);t.Summary=s},function(e,t,a){"use strict";var n=a(18),r=a(19),i=a(8),o=function(){function e(e){var t=this;this.app=e,this.normandy=new n.Normandy(!0,!0,!0),this.stage=ko.observable(void 0),this.bootstrapTeammates(),this.serialised=ko.forcibleComputed(function(){return t.stage()?t.serialise():""})}return e.prototype.serialise=function(){return this.app.serialisation.serialise(this)},e.prototype.applySerialisedState=function(e){this.app.serialisation.applySerialisedState(this,e)},e.prototype.bootstrapTeammates=function(){this._teammates=new r.Teammates(_.chain(this.app.getHenchmen()).map(function(e){return new i.Teammate(e,e.is_essential,!1,!1)}).sortBy(function(e){return e.henchman.name}).value()),this.teammates=ko.observable(this._teammates)},e}();t.State=o},function(e,t,a){"use strict";var n=a(11),r=function(){function e(e,t,a,r){var i=this;void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===a&&(a=!1),void 0===r&&(r=0),this.has_armour=ko.observable(e),this.has_shielding=ko.observable(t),this.has_thanix_cannon=ko.observable(a),this._delay=ko.observable(r),this.delay=ko.pureComputed({read:function(){return i._delay()},write:function(e){var t=parseInt(""+e,10);!_.isNaN(t)&&t>=n.NormandyDelayOptions.None&&t<=n.NormandyDelayOptions.Many&&i._delay(t)}})}return e}();t.Normandy=r},function(e,t,a){"use strict";var n=a(25),r=function(){function e(e){this.oa=new n.ObjectArray(e)}return e.fromObjectArray=function(t){return new e(t.elements)},e.prototype.value=function(){return this.oa.elements},e.prototype.first=function(){return this.oa.first()},e.prototype.last=function(){return this.oa.last()},e.prototype.length=function(){return this.oa.length()},e.prototype.whoAreAlive=function(){return this.filter(function(e){return!e.is_dead()})},e.prototype.die=function(e,t){return this.each(function(a){a.die(e,t)}),this},e.prototype.whoAreRecruited=function(){return this.filter(function(e){return e.is_recruited()})},e.prototype.addRole=function(e){return this.each(function(t){t.addRole(e)}),this},e.prototype.removeRole=function(e){return this.each(function(t){t.removeRole(e)}),this},e.prototype.withRole=function(e){return this.filter(function(t){return t.hasRole(e)})},e.prototype.withAnyOfTheseRoles=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.filter(function(t){return t.hasAnyOfTheseRoles.apply(t,e)})},e.prototype.withoutRole=function(e){return this.filter(function(t){return!t.hasRole(e)})},e.prototype.withoutAnyOfTheseRoles=function(){
for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.filter(function(t){return!t.hasAnyOfTheseRoles.apply(t,e)})},e.prototype.sortByHenchmanProperty=function(e,t){return void 0===t&&(t=!0),this.sort(function(a){return(t?1:-1)*a.henchman[e]})},e.prototype.sortByShieldingDeathPriority=function(e){return void 0===e&&(e=!0),this.sortByHenchmanProperty("shielding_death_priority",e)},e.prototype.sortByArmourDeathPriority=function(e){return void 0===e&&(e=!0),this.sortByHenchmanProperty("armour_death_priority",e)},e.prototype.sortByCannonDeathPriority=function(e){return void 0===e&&(e=!0),this.sortByHenchmanProperty("cannon_death_priority",e)},e.prototype.sortByLongWalkDeathPriority=function(e){return void 0===e&&(e=!0),this.sortByHenchmanProperty("long_walk_death_priority",e)},e.prototype.sortByDefenceReportPriority=function(e){return void 0===e&&(e=!0),this.sortByHenchmanProperty("defence_report_priority",e)},e.prototype.sortByKeepBasePriority=function(e){return void 0===e&&(e=!0),this.sortByHenchmanProperty("keep_base_priority",e)},e.prototype.sortByDestroyBasePriority=function(e){return void 0===e&&(e=!0),this.sortByHenchmanProperty("destroy_base_priority",e)},e.prototype.sortByIsRecruited=function(e){return void 0===e&&(e=!0),this.sort(function(e){return e.is_recruited()?0:1})},e.prototype.whoAdvocateKeepingTheBase=function(){return this.filter(function(e){return e.henchman.keep_base_priority>0})},e.prototype.whoAdvocateDestroyingTheBase=function(){return this.filter(function(e){return e.henchman.destroy_base_priority>0})},e.prototype.without=function(){for(var t=[],a=0;a<arguments.length;a++)t[a-0]=arguments[a];return e.fromObjectArray(this.oa.without.apply(this.oa,t))},e.prototype.filter=function(t){return e.fromObjectArray(this.oa.filter(t))},e.prototype.map=function(e){return this.oa.map(e)},e.prototype.find=function(e){return this.oa.find(e)},e.prototype.findByHenchman=function(e){return this.findByHenchmanID(e.id)},e.prototype.findByHenchmanID=function(e){return this.find(function(t){return t.henchman.id===e})},e.prototype.sort=function(t){return e.fromObjectArray(this.oa.sort(t))},e.prototype.slice=function(t,a){return e.fromObjectArray(this.oa.slice(t,a))},e.prototype.getHoldTheLineTotal=function(){var e=_.map(this.oa.elements,function(e){return e.getHoldTheLineScore()});return _.reduce(e,function(e,t){return e+t},0)},e.prototype.getHoldTheLineScore=function(){return this.getHoldTheLineTotal()/this.length()},e.prototype.getHoldTheLineDeathCount=function(){var e=this.length(),t=this.getHoldTheLineScore();return 2>t?e>=5?t>=1.5?1:t>=.5?2:3:4===e?t>=1?1:t>=.5?2:t>0?3:4:3===e?t>=1?1:t>0?2:3:2===e?t>0?1:2:1:0},e.prototype.whoDieHoldingTheLine=function(){var t=this.getHoldTheLineDeathCount();return t>0?this.sort(function(e){return e.henchman.htl_death_priority+(e.is_loyal()?0:100)}).slice(-t):new e([])},e.prototype.each=function(e){this.oa.each(e)},e}();t.Teammates=r},function(e,t,a){"use strict";var n=a(18),r=a(8),i=a(19),o=a(17),s=a(11),u=function(){function e(e){this.app=e}return e.lpad=function(e,t){void 0===t&&(t=2);var a=e;return a.length>=t?a:new Array(t-a.length+1).join("0")+a},e.indexesToFlags=function(e){return _.reduce(e,function(e,t){return e+Math.pow(2,t)},0)},e.flagsToIndexes=function(e){for(var t=[],a=0,n=1;e>=n;)e&n&&t.push(a),a++,n*=2;return t},e.getRoleCount=function(){return _.keys(s.TeammateRoles).length/2},e.prototype.serialise=function(t){var a=this,n=[e.lpad(t.stage().id.toString(16),1),this.serialiseNormandy(t.normandy),_.map(t.teammates().value(),function(e){return a.serialiseTeammate(e)}).join("")];return n.join("")},e.prototype.deserialise=function(t){var a=this,n=t.match(e.SerialisedRegex);if(n){var r=new o.State(this.app);return r.stage(this.app.stager.getStage(parseInt("0x"+n[s.SerialisedElements.StageID],16))),r.normandy=this.deserialiseNormandyElements(n[s.SerialisedElements.NormandyDelay],n[s.SerialisedElements.NormandyFlags]),r.teammates(new i.Teammates(_.map(n[s.SerialisedElements.Teammates].match(e.TeammatesRegex),function(e){return a.deserialiseTeammate(e)}))),r}throw new Error("Serialised data was malformed.")},e.prototype.applySerialisedState=function(e,t){var a=this.deserialise(t);e.normandy.delay(a.normandy.delay()),e.normandy.has_armour(a.normandy.has_armour()),e.normandy.has_shielding(a.normandy.has_shielding()),e.normandy.has_thanix_cannon(a.normandy.has_thanix_cannon());var n=a.teammates();e.teammates().each(function(e){var t=n.findByHenchman(e.henchman);e.is_recruited(t.is_recruited()),e.is_loyal(t.is_loyal()),e.is_dead(t.is_dead()),e.roles.removeAll(),_.each(t.roles(),function(t){e.addRole(t)}),e.death_cause=t.death_cause,e.death_stage_id=t.death_stage_id}),e.stage(a.stage())},e.prototype.serialiseTeammate=function(t){var a=e.getRoleCount(),n=t.roles().slice(0);t.is_recruited()&&n.push(a+1),t.is_loyal()&&n.push(a+2),t.is_dead()&&n.push(a+3);var r=[e.lpad(t.henchman.id.toString(16),1),e.lpad((void 0===t.death_cause()?0:t.death_cause()+1).toString(16),1),e.lpad((t.death_stage_id()||0).toString(16),1),e.lpad(e.indexesToFlags(n).toString(16),5)];return r.join("")},e.prototype.deserialiseTeammate=function(t){var a=t.match(e.TeammateRegex),n=parseInt("0x"+a[s.SerialisedTeammateElements.HenchmanID],16),i=parseInt("0x"+a[s.SerialisedTeammateElements.DeathCause],16),o=parseInt("0x"+a[s.SerialisedTeammateElements.DeathStageID],16)||void 0,u=e.flagsToIndexes(parseInt("0x"+a[s.SerialisedTeammateElements.Roles],16)),h=e.getRoleCount(),l=_.indexOf(u,h+1)>=0,c=_.indexOf(u,h+2)>=0,d=_.indexOf(u,h+3)>=0;u=_.without(u,h+1,h+2,h+3);var m=new r.Teammate(this.app.getHenchman(n),l,c,d,u);return d&&m.die(o,i-1),m},e.prototype.serialiseNormandy=function(t){var a=0+(t.has_armour()?1:0)+(t.has_shielding()?2:0)+(t.has_thanix_cannon()?4:0),n=[e.lpad(t.delay().toString(10),2),e.lpad(a.toString(10),1)];return n.join("")},e.prototype.deserialiseNormandyElements=function(e,t){var a=parseInt(e,10),r=parseInt(t,10),i=!!(1&r),o=!!(2&r),s=!!(4&r);return new n.Normandy(i,o,s,a)},e.TeammateRegex=/^([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f]{5})$/,e.TeammatesRegex=/[0-9a-f]{8}/g,e.SerialisedRegex=/^([0-9a-f])([\d]{2})([\d])((?:[0-9a-f]{2}[0-9a-f][0-9a-f]{5}){12})$/,e}();t.Serialisation=u},function(e,t){},,,,function(e,t){"use strict";var a=function(){function e(e){this.elements=e}return e.prototype.first=function(){return this.elements.length?this.elements[0]:void 0},e.prototype.last=function(){return this.elements.length?this.elements[this.elements.length-1]:void 0},e.prototype.length=function(){return this.elements.length},e.prototype.push=function(e){var t=this.cloneElements();return t.push(e),this.factory(t)},e.prototype.unshift=function(e){var t=this.cloneElements();return t.unshift(e),this.factory(t)},e.prototype.slice=function(e,t){return this.factory(this.elements.slice(e,t))},e.prototype.sort=function(e){var t=_.sortBy(this.cloneElements(),e);return this.factory(t)},e.prototype.filter=function(e){var t=_.filter(this.cloneElements(),e);return this.factory(t)},e.prototype.without=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];e.unshift.apply(e,this.cloneElements());var a=_.without.apply(_,e);return this.factory(a)},e.prototype.find=function(e){return _.find(this.elements,e)},e.prototype.map=function(e){return _.map(this.elements,e)},e.prototype.each=function(e){_.each(this.elements,e)},e.prototype.cloneElements=function(){return this.elements.slice(0)},e.prototype.factory=function(t){return new e(t)},e}();t.ObjectArray=a}]);
//# sourceMappingURL=bundle.1.0.0.js.map